<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0a0000">
<title>Regal Restaurant</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,500;0,600;0,700;1,500&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --black: #080505; --deep: #100808; --card: #150a0a; --card2: #1e0f0f;
    --red: #c8102e; --red2: #e8182f; --red-dim: rgba(200,16,46,0.15);
    --red-border: rgba(200,16,46,0.3); --gold: #d4af37; --white: #fdfbfb;
    --muted: #a39292; --nav-h: 70px;
  }
  * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
  body { background:var(--black); color:var(--white); font-family:'Outfit',sans-serif; min-height:100vh; overflow-x:hidden; padding-bottom:var(--nav-h); }

  /* HEADER - Upgraded with Glassmorphism */
  .header { background:rgba(13, 2, 2, 0.85); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); padding:20px 20px 16px; position:sticky; top:0; z-index:100; border-bottom:1px solid rgba(212, 175, 55, 0.15); box-shadow:0 10px 30px rgba(0,0,0,0.5); }
  .header-top { display:flex; align-items:center; justify-content:space-between; margin-bottom:14px; }
  .logo-area { display:flex; align-items:center; gap:12px; }
  .logo-icon { width:48px; height:48px; background:linear-gradient(135deg,var(--red),#5a0010); border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:22px; box-shadow:0 4px 15px rgba(200,16,46,0.4); border:1px solid rgba(212, 175, 55, 0.3); }
  .restaurant-name { font-family:'Cormorant Garamond',serif; font-size:26px; font-weight:700; color:var(--white); letter-spacing:1px; line-height:1; }
  .restaurant-sub { font-size:10px; color:var(--gold); letter-spacing:3px; text-transform:uppercase; font-weight:500; margin-top: 2px;}
  .cart-btn { position:relative; background:var(--card2); border:1px solid var(--red-border); color:var(--white); width:44px; height:44px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:18px; cursor:pointer; transition:all 0.2s; }
  .cart-btn:active { transform:scale(0.92); }
  .cart-badge { position:absolute; top:-6px; right:-6px; background:var(--gold); color:#000; font-size:11px; font-weight:700; width:20px; height:20px; border-radius:50%; display:none; align-items:center; justify-content:center; }
  
  .search-wrap { position:relative; margin-bottom:14px; }
  .search-wrap i { position:absolute; left:14px; top:50%; transform:translateY(-50%); color:var(--muted); font-size:14px; }
  .search-input { width:100%; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.1); border-radius:12px; color:var(--white); font-family:'Outfit',sans-serif; font-size:14px; padding:12px 14px 12px 38px; outline:none; transition:all 0.3s ease; }
  .search-input::placeholder { color:var(--muted); font-weight: 300; }
  .search-input:focus { border-color:var(--gold); background:rgba(212, 175, 55, 0.05); box-shadow: 0 0 10px rgba(212, 175, 55, 0.1); }
  
  .cats-scroll { display:flex; gap:8px; overflow-x:auto; padding-bottom:4px; scrollbar-width:none; }
  .cats-scroll::-webkit-scrollbar { display:none; }
  .cat-pill { flex-shrink:0; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.08); border-radius:20px; color:var(--muted); font-size:12px; font-weight:500; padding:8px 16px; cursor:pointer; letter-spacing:0.5px; transition:all 0.2s; white-space:nowrap; }
  .cat-pill.active { background:linear-gradient(135deg, var(--red), #8b0019); border-color:var(--red); color:#fff; box-shadow:0 4px 12px rgba(200,16,46,0.3); font-weight: 600;}

  /* PAGES */
  .page { display:none; animation: fadeIn 0.3s ease; } .page.active { display:block; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
  .content { padding:20px 14px; }
  
  .section-title { font-family:'Cormorant Garamond',serif; font-size:22px; font-weight:700; color:var(--white); letter-spacing:0.5px; margin-bottom:14px; display:flex; align-items:center; gap:10px; }
  .section-title::after { content:''; flex:1; height:1px; background:linear-gradient(90deg,var(--red-border),transparent); }
  .section-label { font-size:10px; color:var(--gold); letter-spacing:2px; margin-bottom:4px; text-transform:uppercase; font-weight:600; }

  /* GRID */
  .menu-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
  .menu-card { background:var(--card); border:1px solid rgba(255,255,255,0.04); border-radius:16px; padding:16px 14px; cursor:pointer; transition:all 0.2s; position:relative; overflow:hidden; display:flex; flex-direction:column; justify-content:space-between; min-height:130px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
  .menu-card::before { content:''; position:absolute; top:0; left:0; right:0; height:2px; background:linear-gradient(90deg,var(--gold),transparent); opacity:0; transition:opacity 0.2s; }
  .menu-card:active { transform:scale(0.96); border-color:var(--gold); background:var(--card2); }
  .menu-card:active::before { opacity:1; }
  .card-name { font-size:13px; font-weight:600; color:var(--white); line-height:1.3; letter-spacing:0.2px; margin-bottom:6px; }
  .card-desc { font-size:11px; color:var(--muted); margin-bottom:10px; line-height:1.4; font-weight:300; }
  .card-bottom { display:flex; align-items:center; justify-content:space-between; margin-top:auto; }
  .card-price { font-family:'Outfit',sans-serif; font-size:14px; font-weight:600; color:var(--gold); }
  .add-btn { width:32px; height:32px; background:var(--red-dim); border:1px solid var(--red-border); border-radius:10px; color:var(--white); font-size:16px; display:flex; align-items:center; justify-content:center; cursor:pointer; transition:all 0.2s; flex-shrink:0; }
  .add-btn:active { transform:scale(0.85); background: var(--red); }
  .add-btn.in-cart { background:var(--gold); color:#000; border-color:var(--gold); box-shadow:0 2px 10px rgba(212, 175, 55, 0.4); }
  .menu-section { margin-bottom:32px; }

  /* CART ITEMS */
  .cart-empty { display:flex; flex-direction:column; align-items:center; justify-content:center; padding:80px 30px; gap:16px; text-align:center; }
  .cart-empty i { font-size:60px; color:var(--red-border); }
  .cart-empty p { color:var(--muted); font-size:14px; font-weight:300;}
  .cart-empty h3 { font-family:'Cormorant Garamond',serif; font-size:24px; color:var(--white); }
  .cart-list { padding:16px 14px 0; }
  .cart-item { background:var(--card); border:1px solid rgba(255,255,255,0.04); border-radius:16px; padding:16px; margin-bottom:12px; display:flex; align-items:center; gap:12px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
  .cart-item-info { flex:1; }
  .cart-item-name { font-size:14px; font-weight:500; color:var(--white); margin-bottom:6px; }
  .cart-item-price { font-size:14px; color:var(--gold); font-weight:600; }
  .qty-ctrl { display:flex; align-items:center; gap:12px; background: rgba(0,0,0,0.3); padding: 4px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05);}
  .qty-btn { width:28px; height:28px; border-radius:8px; border:none; background:var(--card2); color:var(--white); font-size:16px; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:all 0.15s; }
  .qty-btn:active { background:var(--red); color:#fff; }
  .qty-num { font-size:14px; font-weight:600; color:var(--white); min-width:20px; text-align:center; }

  /* SMART SUGGESTIONS */
  .suggestions-wrap { margin: 10px 0 20px; }
  .suggestions-title { font-family: 'Cormorant Garamond', serif; font-size: 18px; color: var(--gold); margin: 0 14px 12px; font-style: italic;}
  .suggestions-scroll { display: flex; gap: 12px; overflow-x: auto; padding: 0 14px 10px; scrollbar-width: none; }
  .suggestions-scroll::-webkit-scrollbar { display: none; }
  .suggest-card { min-width: 140px; background: linear-gradient(160deg, var(--card) 0%, #150505 100%); border: 1px solid var(--red-border); border-radius: 14px; padding: 12px; display: flex; flex-direction: column; justify-content: space-between; box-shadow: 0 4px 10px rgba(200,16,46,0.1); }
  .suggest-name { font-size: 12px; font-weight: 500; color: var(--white); margin-bottom: 4px; line-height: 1.3;}
  .suggest-cat { font-size: 9px; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;}
  .suggest-bottom { display: flex; justify-content: space-between; align-items: center; margin-top: 8px;}
  .suggest-price { color: var(--gold); font-size: 13px; font-weight: 600; }
  .suggest-add { background: var(--red); color: #fff; border: none; border-radius: 8px; width: 26px; height: 26px; display: flex; justify-content: center; align-items: center; cursor: pointer; transition: 0.2s;}
  .suggest-add:active { transform: scale(0.9); }

  /* ORDER TYPE */
  .order-type-section { margin:14px 14px 0; background:var(--card); border:1px solid rgba(255,255,255,0.05); border-radius:16px; padding:20px 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); }
  .order-type-title { font-size:12px; color:var(--gold); letter-spacing:2px; text-transform:uppercase; font-weight:600; margin-bottom:16px; display:flex; align-items:center; gap:8px;}
  .order-type-tabs { display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin-bottom:18px; }
  .type-tab { background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.05); border-radius:12px; padding:14px 6px; text-align:center; cursor:pointer; transition:all 0.3s ease; }
  .type-tab.active { background:var(--red-dim); border-color:var(--red); box-shadow:0 0 15px rgba(200,16,46,0.15); transform: translateY(-2px);}
  .type-tab i { font-size:20px; display:block; margin-bottom:8px; color:var(--muted); transition: color 0.3s;}
  .type-tab.active i { color:var(--gold); }
  .type-tab span { font-size:11px; font-weight:500; color:var(--muted); letter-spacing:0.5px; }
  .type-tab.active span { color:var(--white); font-weight: 600;}

  /* FORM FIELDS */
  .field-wrap { margin-top:4px; }
  .field-label { font-size:12px; color:var(--muted); margin-bottom:8px; font-weight:500; letter-spacing:0.5px; display:block; }
  .field-input { width:100%; background:rgba(0,0,0,0.3); border:1px solid rgba(255,255,255,0.1); border-radius:12px; color:var(--white); font-family:'Outfit',sans-serif; font-size:14px; padding:14px; outline:none; transition:all 0.3s; margin-bottom:12px; }
  .field-input:focus { border-color:var(--gold); background:rgba(212, 175, 55, 0.05); }
  .field-input::placeholder { color:var(--muted); font-weight:300;}

  /* SUMMARY */
  .order-summary { margin:16px 14px 0; background:var(--card); border:1px solid rgba(255,255,255,0.05); border-radius:16px; padding:20px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);}
  .summary-row { display:flex; justify-content:space-between; align-items:center; padding:8px 0; font-size:14px; color:var(--muted); font-weight: 300;}
  .summary-row.total { border-top:1px dashed rgba(255,255,255,0.1); margin-top:10px; padding-top:16px; font-size:20px; font-weight:700; color:var(--white); font-family:'Cormorant Garamond',serif; }
  .summary-row.total span:last-child { color:var(--gold); }

  .checkout-btn { display:flex; align-items:center; justify-content:center; gap:10px; width:calc(100% - 28px); margin:20px 14px; background:linear-gradient(135deg,#25d366,#128c4e); color:#fff; border:none; border-radius:14px; padding:18px; font-family:'Outfit',sans-serif; font-size:15px; font-weight:600; letter-spacing:1px; cursor:pointer; text-transform:uppercase; box-shadow:0 6px 20px rgba(37,211,102,0.3); transition:all 0.2s; }
  .checkout-btn:active { transform:scale(0.97); }
  .checkout-btn i { font-size:22px; }

  /* BOTTOM NAV - Glassmorphism */
  .bottom-nav { position:fixed; bottom:0; left:0; right:0; height:var(--nav-h); background:rgba(10, 5, 5, 0.9); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border-top:1px solid rgba(255,255,255,0.05); display:flex; align-items:center; justify-content:space-around; z-index:200; padding-bottom:env(safe-area-inset-bottom); box-shadow:0 -4px 30px rgba(0,0,0,0.8); }
  .nav-item { display:flex; flex-direction:column; align-items:center; gap:6px; cursor:pointer; padding:8px 20px; border-radius:12px; transition:all 0.2s; position:relative; }
  .nav-item.active .nav-icon { color:var(--gold); transform: translateY(-2px); } .nav-item.active .nav-label { color:var(--gold); }
  .nav-icon { font-size:20px; color:var(--muted); transition:all 0.3s; }
  .nav-label { font-size:11px; font-weight:500; color:var(--muted); letter-spacing:0.5px; transition:color 0.3s; }
  .nav-badge { position:absolute; top:4px; right:12px; background:var(--red); color:#fff; font-size:9px; font-weight:700; width:16px; height:16px; border-radius:50%; display:none; align-items:center; justify-content:center; box-shadow: 0 2px 5px rgba(200,16,46,0.5);}

  /* MODAL */
  .overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.85); z-index:300; backdrop-filter:blur(6px); -webkit-backdrop-filter: blur(6px); }
  .overlay.show { display:flex; align-items:flex-end; }
  .modal { background:linear-gradient(180deg, #1e0f0f 0%, #100505 100%); border:1px solid rgba(212,175,55,0.2); border-bottom:none; border-radius:28px 28px 0 0; padding:24px 24px; padding-bottom:calc(24px + env(safe-area-inset-bottom)); width:100%; animation:slideUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 -10px 40px rgba(0,0,0,0.5);}
  @keyframes slideUp { from{transform:translateY(100%)} to{transform:translateY(0)} }
  .modal-handle { width:40px; height:5px; background:rgba(255,255,255,0.2); border-radius:3px; margin:0 auto 24px; }
  .modal-name { font-family:'Cormorant Garamond',serif; font-size:26px; font-weight:700; color:var(--white); margin-bottom:8px; line-height: 1.1;}
  .modal-cat { font-size:11px; color:var(--gold); letter-spacing:2px; text-transform:uppercase; margin-bottom:16px; font-weight: 500;}
  .modal-desc { font-size:14px; color:var(--muted); margin-bottom:24px; line-height:1.6; font-weight: 300;}
  .modal-price { font-family:'Outfit',sans-serif; font-size:28px; font-weight:700; color:var(--gold); margin-bottom:24px; }
  .modal-price small { font-size:14px; color:var(--muted); font-weight:300; }
  .modal-qty { display:flex; align-items:center; gap:20px; margin-bottom:24px; background: rgba(0,0,0,0.3); padding: 8px 16px; border-radius: 16px; display: inline-flex; border: 1px solid rgba(255,255,255,0.05);}
  .modal-qty-btn { width:40px; height:40px; border-radius:12px; border:none; background:var(--card2); color:var(--white); font-size:20px; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:all 0.15s; }
  .modal-qty-btn:active { background:var(--red); }
  .modal-qty-num { font-size:20px; font-weight:600; min-width:30px; text-align:center; }
  .modal-add-btn { width:100%; background:linear-gradient(135deg,var(--red),#8b0019); color:#fff; border:none; border-radius:16px; padding:18px; font-family:'Outfit',sans-serif; font-size:15px; font-weight:600; letter-spacing:1px; cursor:pointer; text-transform:uppercase; box-shadow:0 8px 25px rgba(200,16,46,0.4); transition:all 0.2s; }
  .modal-add-btn:active { transform:scale(0.97); }

  .toast { position:fixed; top:120px; left:50%; transform:translateX(-50%) translateY(-20px); background:rgba(212, 175, 55, 0.15); border:1px solid var(--gold); backdrop-filter: blur(10px); color:var(--white); font-size:14px; font-weight:500; padding:12px 24px; border-radius:30px; z-index:999; opacity:0; transition:all 0.3s; white-space:nowrap; box-shadow:0 10px 30px rgba(0,0,0,0.5); pointer-events:none; }
  .toast.show { opacity:1; transform:translateX(-50%) translateY(0); }
</style>
</head>
<body>

<div class="header">
  <div class="header-top">
    <div class="logo-area">
          <div class="logo-icon"><img src="https://scontent.flhe2-4.fna.fbcdn.net/v/t39.30808-6/356909809_283299210876879_3802934854133006868_n.jpg?_nc_cat=111&ccb=1-7&_nc_sid=1d70fc&_nc_eui2=AeEVCRwYVlqAumpIFMn5dAgghvjPGxTe7tuG-M8bFN7u24XfDBtL2Q-g5-E59S1__Q2hKwC-wxW6vJ4OA7E4og9A&_nc_ohc=GgqFimIFVTgQ7kNvwFLYZUB&_nc_oc=AdnZgIFIzUrY0tRBZBZ51Elo4C9PXgMU0ieO_L6EfFZoJwUBiFCXgVSnDZ_8_EDxqh8&_nc_zt=23&_nc_ht=scontent.flhe2-4.fna&_nc_gid=02cLPmWQmDrB8n3qCzlTng&oh=00_AftV_LtemHrAUkYIQ6lb0Lz_CFVOrs01iDo_mPPlf7FCsQ&oe=699CB570" alt="Regal Logo" style="width:36px; height:36px; object-fit:contain;"></div>
      <div>
        <div class="restaurant-name">Regal</div>
        <div class="restaurant-sub">Restaurant</div>
      </div>
    </div>
    <button class="cart-btn" onclick="goToCart()">
      <i class="fas fa-shopping-bag"></i>
      <span class="cart-badge" id="headerCartBadge"></span>
    </button>
  </div>
  <div class="search-wrap">
    <i class="fas fa-search"></i>
    <input class="search-input" type="text" id="searchInput" placeholder="Search our regal menu..." oninput="filterMenu()">
  </div>
  <div class="cats-scroll" id="catPills"></div>
</div>

<div id="pageMenu" class="page active">
  <div class="content" id="menuContent"></div>
</div>

<div id="pageCart" class="page">
  <div id="cartContent"></div>
</div>

<nav class="bottom-nav">
  <div class="nav-item active" id="navHome" onclick="goToHome()">
    <i class="fas fa-concierge-bell nav-icon"></i>
    <span class="nav-label">Menu</span>
  </div>
  <div class="nav-item" id="navCart" onclick="goToCart()">
    <i class="fas fa-shopping-bag nav-icon"></i>
    <span class="nav-label">Cart</span>
    <span class="nav-badge" id="navCartBadge"></span>
  </div>
</nav>

<div class="toast" id="toast"></div>

<div class="overlay" id="overlay" onclick="closeModal(event)">
  <div class="modal">
    <div class="modal-handle"></div>
    <div class="modal-cat" id="mCat"></div>
    <div class="modal-name" id="mName"></div>
    <div class="modal-desc" id="mDesc"></div>
    <div class="modal-price" id="mPrice"></div>
    <div class="modal-qty">
      <button class="modal-qty-btn" onclick="changeModalQty(-1)">‚àí</button>
      <div class="modal-qty-num" id="mQty">1</div>
      <button class="modal-qty-btn" onclick="changeModalQty(1)">+</button>
    </div>
    <button class="modal-add-btn" onclick="addFromModal()">Add to Order</button>
  </div>
</div>

<script>
// Menu Data remains the same
const MENU = [
  { category:"CHINESE - GRAVYS", items:[ {name:"CHICKEN BLACK PEPPER",price:975,description:"Full"}, {name:"SPECIAL CHICKEN",price:1450,description:"Full"}, {name:"CHICKEN SZECHUAN",price:950,description:"Full"}, {name:"CHICKEN ALMOND",price:1000,description:"Full"}, {name:"CHICKEN MANCHURIAN",price:1180,description:"Full"}, {name:"SPECIAL CHOWMEIN",price:1300,description:"Full"}, {name:"CHICKEN CHOWMEIN",price:1150,description:"Full / Half"}, {name:"SHASHLIK CHICKEN",price:1050,description:"Full / Half"} ]},
  { category:"THAI CHINESE - GRAVYS", items:[ {name:"THAI CASHEW NUT CHICKEN",price:1200,description:""}, {name:"THAI CHICKEN CHILLI MINT",price:1100,description:""}, {name:"THAI GREEN CORIANDER CHICKEN",price:1050,description:""}, {name:"THAI KUNG POW CHICKEN",price:1195,description:""}, {name:"THAI CHILLI DRY",price:1050,description:""}, {name:"CHICKEN OYSTER SAUCE",price:975,description:""} ]},
  { category:"THAI CHINESE - RICE", items:[ {name:"SPECIAL RICE",price:930,description:""}, {name:"CHICKEN FRIED RICE",price:780,description:""}, {name:"CHICKEN MASALA FRIED RICE",price:790,description:""}, {name:"EGG FRIED RICE",price:710,description:""}, {name:"VEG FRIED RICE",price:690,description:""}, {name:"GARLIC RICE",price:670,description:""}, {name:"THAI CHILLI RICE",price:695,description:""}, {name:"PLAIN RICE",price:495,description:""} ]},
  { category:"NAAN", items:[ {name:"KALONJI NAAN",price:150,description:""}, {name:"SPECIAL NAAN",price:200,description:""}, {name:"CHICKEN CHEESE NAAN",price:190,description:""}, {name:"GARLIC NAAN",price:150,description:""}, {name:"ROGNI NAAN",price:120,description:""}, {name:"TANDOORI PARATHA",price:150,description:""}, {name:"CHAPATI",price:80,description:""}, {name:"ACHARI NAAN",price:140,description:""}, {name:"KHAMEERI ROTI",price:35,description:""}, {name:"MINT NAAN",price:160,description:""}, {name:"PER HEAD ROTI",price:120,description:""} ]},
  { category:"CONTINENTAL MENU", items:[ {name:"SPECIAL STEAK",price:1215,description:""}, {name:"CHICKEN PEPPER STEAK",price:1150,description:""}, {name:"CHICKEN ITALIAN STEAK",price:1195,description:""}, {name:"MEXICAN STEAK",price:1095,description:""}, {name:"MUSHROOM CHICKEN STEAK",price:1075,description:""}, {name:"CHICKEN TARRAGON STEAK",price:1150,description:""}, {name:"CHICKEN AMERICAN STEAK",price:1175,description:""}, {name:"B.B.Q STEAK",price:995,description:""}, {name:"MEXICAN CHICKEN WITH RICE",price:995,description:""}, {name:"CHICKEN ALFREDO PASTA",price:1075,description:""}, {name:"CHICKEN MEXICAN PASTA",price:895,description:""}, {name:"CHICKEN PENNE PASTA",price:1350,description:""}, {name:"CHICKEN LASAGNA",price:1045,description:""}, {name:"CHICKEN MOZZARELLA STEAK",price:1125,description:""}, {name:"FRIED FINGER FISH",price:1395,description:"6 PCS"}, {name:"FRIED FISH",price:1700,description:"4 PCS"}, {name:"GRILL FISH",price:1845,description:""}, {name:"CHICKEN GRILL SHASHLIK WITH RICE",price:890,description:""}, {name:"TEMPURA PRAWNS",price:2295,description:"6 PCS"}, {name:"CLUB SANDWICH",price:500,description:""}, {name:"PANINI SANDWICH",price:650,description:""} ]},
  { category:"SWEETS", items:[ {name:"CHOCOLATE BROWNIE",price:750,description:""}, {name:"ALMOND MOUSSE",price:695,description:""}, {name:"CHOCOLATE MOUSSE",price:575,description:""}, {name:"AUSTRALIAN MOUSSE",price:595,description:""}, {name:"CARAMEL MOUSSE",price:695,description:""}, {name:"EGG PUDDING",price:595,description:""}, {name:"KHEER",price:465,description:""}, {name:"FRUIT TRIFLE",price:435,description:""}, {name:"JELLY",price:150,description:""}, {name:"MOLTEN LAVA CAKE",price:455,description:""}, {name:"CHEESE CAKE",price:765,description:""}, {name:"BASBOUSA",price:855,description:""}, {name:"GULAB JAMUN",price:900,description:""} ]},
  { category:"PASTRY", items:[ {name:"WHITE FOREST PASTRY",price:530,description:""}, {name:"BLACK FOREST PASTRY",price:530,description:""}, {name:"RED VELVET PASTRY",price:530,description:""}, {name:"PINEAPPLE PASTRY",price:530,description:""} ]},
  { category:"SHAKES", items:[ {name:"ICE CREAM SHAKE",price:680,description:""}, {name:"CHOCOLATE SHAKE",price:630,description:""}, {name:"VANILLA SHAKE",price:480,description:""}, {name:"STRAWBERRY SHAKE",price:520,description:""}, {name:"KULFA SHAKE",price:330,description:""}, {name:"MANGO SHAKE",price:480,description:""}, {name:"PISTA SHAKE",price:630,description:""}, {name:"OREO SHAKE",price:660,description:""}, {name:"KIT KAT SHAKE",price:780,description:""}, {name:"SNICKERS SHAKE",price:830,description:""}, {name:"FERRERO SHAKE",price:780,description:""}, {name:"TOBLERONE SHAKE",price:780,description:""}, {name:"NUTELLA SHAKE",price:880,description:""} ]},
  { category:"BAR - FRESH JUICE", items:[ {name:"APPLE JUICE",price:350,description:""}, {name:"PEACH JUICE",price:425,description:""}, {name:"POMEGRANATE JUICE",price:900,description:""}, {name:"MANGO JUICE",price:350,description:""}, {name:"GRAPES JUICE",price:475,description:""} ]},
  { category:"BAR - MOCKTAILS", items:[ {name:"MINT MARGARITA",price:375,description:""}, {name:"PEACH MARGARITA",price:350,description:""}, {name:"APPLE MARGARITA",price:375,description:""}, {name:"BLUE LAGOON",price:375,description:""}, {name:"PINA COLADA",price:390,description:""}, {name:"SEVEN HEAVEN",price:450,description:""}, {name:"PEACH GRAFFITI",price:450,description:""}, {name:"FRESH LEMON GINGER",price:350,description:""}, {name:"BEETROOT MARGARITA",price:375,description:""}, {name:"JAMAICAN DRINK",price:450,description:""} ]},
  { category:"BAR - COFFEE & TEA", items:[ {name:"CAPPUCCINO",price:350,description:""}, {name:"LATTE",price:300,description:""}, {name:"BLACK COFFEE",price:180,description:""}, {name:"MOCHA",price:250,description:""}, {name:"HOT CHOCOLATE",price:450,description:""}, {name:"GREEN TEA",price:100,description:""}, {name:"COLD COFFEE",price:450,description:""}, {name:"TEA",price:120,description:""}, {name:"KARAK CHAI",price:150,description:""}, {name:"CARDAMOM TEA",price:180,description:""}, {name:"GINGER TEA",price:160,description:""}, {name:"PESHAWARI KAHWA",price:70,description:""} ]},
  { category:"BAR - DRINKS", items:[ {name:"BOTTLE 1.5L",price:225,description:""}, {name:"BOTTLE 1L",price:175,description:""}, {name:"WATER",price:145,description:"Full / Half: 95"}, {name:"TIN",price:155,description:"Half/PCS: 95"}, {name:"STING",price:155,description:"Half/PCS: 95"}, {name:"NR DRINK",price:95,description:""} ]}
];

// STATE
let cart = {};
let activeCategory = "ALL";
let modalItem = null;
let modalQty = 1;
let orderType = 'dine';
let detectedLocation = '';

function init() { buildCategoryPills(); renderMenu(); }

function buildCategoryPills() {
  const container = document.getElementById('catPills');
  const cats = ["ALL", ...MENU.map(c => c.category)];
  container.innerHTML = cats.map(cat => {
    const label = cat==="ALL" ? "ALL" : cat.length>12 ? cat.substring(0,12)+"‚Ä¶" : cat;
    return `<div class="cat-pill ${cat==="ALL"?"active":""}" onclick="selectCategory(event,'${cat}')" title="${cat}">${label}</div>`;
  }).join('');
}

function selectCategory(e, cat) {
  activeCategory = cat;
  document.querySelectorAll('.cat-pill').forEach(p => p.classList.remove('active'));
  e.target.classList.add('active');
  document.getElementById('searchInput').value = '';
  renderMenu();
}

function filterMenu() {
  activeCategory = "ALL";
  document.querySelectorAll('.cat-pill').forEach((p,i) => p.classList.toggle('active', i===0));
  renderMenu();
}

function renderMenu() {
  const search = document.getElementById('searchInput').value.toLowerCase().trim();
  const container = document.getElementById('menuContent');
  let html = '', total = 0;
  MENU.forEach(section => {
    if (activeCategory!=="ALL" && section.category!==activeCategory) return;
    let items = section.items;
    if (search) items = items.filter(it => it.name.toLowerCase().includes(search));
    if (!items.length) return;
    total += items.length;
    html += `<div class="menu-section"><div class="section-label">${getCatEmoji(section.category)}</div><div class="section-title">${section.category}</div><div class="menu-grid">`;
    items.forEach(item => {
      const key = iKey(section.category, item.name);
      const inCart = cart[key] > 0;
      html += `<div class="menu-card" onclick="openModal('${es(section.category)}','${es(item.name)}',${item.price},'${es(item.description)}')">
        <div><div class="card-name">${item.name}</div>${item.description?`<div class="card-desc">${item.description}</div>`:''}</div>
        <div class="card-bottom">
          <div class="card-price">Rs ${item.price.toLocaleString()}</div>
          <button class="add-btn ${inCart?'in-cart':''}" onclick="quickAdd(event,'${es(section.category)}','${es(item.name)}',${item.price},'${es(item.description)}')">${inCart?'<i class="fas fa-check"></i>':'+'}</button>
        </div></div>`;
    });
    html += `</div></div>`;
  });
  if (!total) html = `<div class="no-results"><i class="fas fa-search"></i><p>No regal dishes found</p></div>`;
  container.innerHTML = html;
}

function getCatEmoji(cat) {
  return {'CHINESE - GRAVYS':'üçú','THAI CHINESE - GRAVYS':'üå∂Ô∏è','THAI CHINESE - RICE':'üçö','NAAN':'ü´ì','CONTINENTAL MENU':'ü•©','SWEETS':'üçÆ','PASTRY':'üç∞','SHAKES':'ü•§','BAR - FRESH JUICE':'üçπ','BAR - MOCKTAILS':'üç∏','BAR - COFFEE & TEA':'‚òï','BAR - DRINKS':'üßä'}[cat] || cat;
}

function es(s) { return (s||'').replace(/\\/g,'\\\\').replace(/'/g,"\\'"); }
function iKey(cat, name) { return cat+'||'+name; }

function quickAdd(e, cat, name, price, desc) {
  e.stopPropagation();
  const key = iKey(cat, name);
  cart[key] = (cart[key]||0)+1;
  cart[key+'__info'] = {name, price, description:desc, category:cat};
  updateCartUI(); renderMenu();
  
  // Only re-render cart if we are on the cart page
  if(document.getElementById('pageCart').classList.contains('active')) {
      renderCart();
  }
  showToast('‚úÖ '+name+' added!');
}

function openModal(cat, name, price, desc) {
  modalItem = {cat, name, price, desc}; modalQty = 1;
  document.getElementById('mCat').textContent = cat;
  document.getElementById('mName').textContent = name;
  document.getElementById('mDesc').textContent = desc || 'A signature dish from our regal kitchen.';
  document.getElementById('mPrice').innerHTML = `Rs ${price.toLocaleString()} <small>per serving</small>`;
  document.getElementById('mQty').textContent = 1;
  document.getElementById('overlay').classList.add('show');
}
function closeModal(e) { if(e.target===document.getElementById('overlay')) document.getElementById('overlay').classList.remove('show'); }
function changeModalQty(d) { modalQty=Math.max(1,modalQty+d); document.getElementById('mQty').textContent=modalQty; }
function addFromModal() {
  if(!modalItem) return;
  const {cat,name,price,desc}=modalItem; const key=iKey(cat,name);
  cart[key]=(cart[key]||0)+modalQty; cart[key+'__info']={name,price,description:desc,category:cat};
  updateCartUI(); renderMenu(); document.getElementById('overlay').classList.remove('show');
  
  if(document.getElementById('pageCart').classList.contains('active')) {
      renderCart();
  }
  showToast(`‚úÖ ${name} √ó ${modalQty} added!`);
}

function updateCartUI() {
  const total = Object.keys(cart).filter(k=>!k.includes('__info')).reduce((s,k)=>s+cart[k],0);
  ['navCartBadge','headerCartBadge'].forEach(id=>{
    const el=document.getElementById(id);
    el.style.display=total>0?'flex':'none'; el.textContent=total;
  });
}

function goToHome() {
  document.getElementById('pageMenu').classList.add('active');
  document.getElementById('pageCart').classList.remove('active');
  document.getElementById('navHome').classList.add('active');
  document.getElementById('navCart').classList.remove('active');
}
function goToCart() {
  document.getElementById('pageMenu').classList.remove('active');
  document.getElementById('pageCart').classList.add('active');
  document.getElementById('navHome').classList.remove('active');
  document.getElementById('navCart').classList.add('active');
  renderCart();
}

// --- RECOMMENDATION ENGINE ---
function getSuggestions() {
  const inCartCats = new Set();
  const inCartNames = new Set();
  
  Object.keys(cart).filter(k=>!k.includes('__info') && cart[k]>0).forEach(key => {
    const info = cart[key+'__info'];
    inCartCats.add(info.category);
    inCartNames.add(info.name);
  });

  if(inCartNames.size === 0) return [];

  let suggestedCats = new Set();
  // Rules for cross-selling
  if(inCartCats.has('THAI CHINESE - RICE')) { suggestedCats.add('CHINESE - GRAVYS'); suggestedCats.add('THAI CHINESE - GRAVYS'); }
  if(inCartCats.has('CHINESE - GRAVYS') || inCartCats.has('THAI CHINESE - GRAVYS')) { suggestedCats.add('THAI CHINESE - RICE'); suggestedCats.add('NAAN'); }
  if(inCartCats.has('CONTINENTAL MENU')) { suggestedCats.add('BAR - MOCKTAILS'); suggestedCats.add('SWEETS'); }
  if(inCartCats.has('NAAN')) { suggestedCats.add('CHINESE - GRAVYS'); }
  
  // Always suggest a dessert or drink if they aren't completely stocking up on them
  suggestedCats.add('BAR - MOCKTAILS');
  suggestedCats.add('SWEETS');

  let potentialItems = [];
  MENU.forEach(sec => {
    if(suggestedCats.has(sec.category)) {
      sec.items.forEach(item => {
        if(!inCartNames.has(item.name)) {
          potentialItems.push({...item, category: sec.category});
        }
      });
    }
  });

  // Shuffle and return top 4
  return potentialItems.sort(() => 0.5 - Math.random()).slice(0, 4);
}

function renderCart() {
  const container = document.getElementById('cartContent');
  const keys = Object.keys(cart).filter(k=>!k.includes('__info')&&cart[k]>0);
  if (!keys.length) {
    container.innerHTML=`<div class="cart-empty"><i class="fas fa-shopping-bag" style="color:var(--gold)"></i><h3>Your cart is empty</h3><p>Add some delicious items from our regal menu</p></div>`;
    return;
  }
  
  let subtotal=0, itemsHtml='';
  keys.forEach(key=>{
    const info=cart[key+'__info'], qty=cart[key];
    subtotal+=info.price*qty;
    itemsHtml+=`<div class="cart-item"><div class="cart-item-info"><div class="cart-item-name">${info.name}</div><div class="cart-item-price">Rs ${(info.price*qty).toLocaleString()}</div></div><div class="qty-ctrl"><button class="qty-btn" onclick="changeCartQty('${es(key)}',-1)">‚àí</button><div class="qty-num">${qty}</div><button class="qty-btn" onclick="changeCartQty('${es(key)}',1)">+</button></div></div>`;
  });
  
  // Get and Build Suggestions
  const suggestions = getSuggestions();
  let suggestionsHtml = '';
  if(suggestions.length > 0) {
    suggestionsHtml = `<div class="suggestions-wrap">
      <div class="suggestions-title">Perfect additions...</div>
      <div class="suggestions-scroll">
        ${suggestions.map(item => `
          <div class="suggest-card">
            <div>
              <div class="suggest-cat">${getCatEmoji(item.category)} ${item.category.split(' - ')[0]}</div>
              <div class="suggest-name">${item.name}</div>
            </div>
            <div class="suggest-bottom">
              <div class="suggest-price">Rs ${item.price.toLocaleString()}</div>
              <button class="suggest-add" onclick="quickAdd(event, '${es(item.category)}', '${es(item.name)}', ${item.price}, '${es(item.description)}')"><i class="fas fa-plus"></i></button>
            </div>
          </div>
        `).join('')}
      </div>
    </div>`;
  }

  const tax=Math.round(subtotal*0.05), total=subtotal+tax;
  container.innerHTML=`
    <div class="cart-list">${itemsHtml}</div>
    ${suggestionsHtml}
    <div class="order-type-section">
      <div class="order-type-title"><i class="fas fa-concierge-bell"></i>Select Order Type</div>
      <div class="order-type-tabs">
        <div class="type-tab ${orderType==='dine'?'active':''}" onclick="setOrderType('dine')"><i class="fas fa-chair"></i><span>Dine In</span></div>
        <div class="type-tab ${orderType==='pickup'?'active':''}" onclick="setOrderType('pickup')"><i class="fas fa-shopping-bag"></i><span>Pickup</span></div>
        <div class="type-tab ${orderType==='delivery'?'active':''}" onclick="setOrderType('delivery')"><i class="fas fa-motorcycle"></i><span>Delivery</span></div>
      </div>
      <div id="orderTypeDetails"></div>
    </div>
    <div class="order-summary">
      <div class="summary-row"><span>Subtotal</span><span>Rs ${subtotal.toLocaleString()}</span></div>
      <div class="summary-row"><span>Tax (5%)</span><span>Rs ${tax.toLocaleString()}</span></div>
      <div class="summary-row total"><span>Total</span><span>Rs ${total.toLocaleString()}</span></div>
    </div>
    <button class="checkout-btn" onclick="placeOrder()">
      <i class="fab fa-whatsapp"></i> Place Order
    </button>`;
  renderOrderTypeDetails();
}

function setOrderType(type) {
  orderType = type; detectedLocation = '';
  document.querySelectorAll('.type-tab').forEach(t=>t.classList.remove('active'));
  event.currentTarget.classList.add('active');
  renderOrderTypeDetails();
}

function renderOrderTypeDetails() {
  const el = document.getElementById('orderTypeDetails');
  if(!el) return;
  if (orderType==='dine') {
    el.innerHTML=`<label class="field-label">Table Number</label><input class="field-input" id="tableNo" type="number" placeholder="Enter your table number" min="1">`;
  } else if (orderType==='pickup') {
    el.innerHTML=`
      <label class="field-label">Your Name</label>
      <input class="field-input" id="pickupName" type="text" placeholder="Name for pickup">
      <label class="field-label mt8">Phone Number</label>
      <input class="field-input" id="pickupPhone" type="tel" placeholder="03XX XXXXXXX">`;
  } else {
    el.innerHTML=`
      <label class="field-label">Delivery Address</label>
      <input class="field-input" id="manualAddress" type="text" placeholder="House no, Street, Area, City">
      <label class="field-label mt8">Phone Number</label>
      <input class="field-input" id="deliveryPhone" type="tel" placeholder="03XX XXXXXXX">`;
  }
}

function changeCartQty(key, d) {
  cart[key]=(cart[key]||0)+d;
  if(cart[key]<=0){ delete cart[key]; delete cart[key+'__info']; }
  updateCartUI(); renderCart(); renderMenu();
}

function placeOrder() {
  const keys=Object.keys(cart).filter(k=>!k.includes('__info')&&cart[k]>0);
  if(!keys.length){ showToast('‚ùå Cart is empty!'); return; }
  let orderDetails='', subtotal=0;

  if(orderType==='dine'){
    const tableNo=document.getElementById('tableNo')?document.getElementById('tableNo').value.trim():'';
    if(!tableNo){ showToast('‚ö†Ô∏è Please enter table number!'); return; }
    orderDetails=`ü™ë *Order Type:* Dine In\nüî¢ *Table No:* ${tableNo}`;
  } else if(orderType==='pickup'){
    const name=document.getElementById('pickupName')?document.getElementById('pickupName').value.trim():'';
    const phone=document.getElementById('pickupPhone')?document.getElementById('pickupPhone').value.trim():'';
    if(!name){ showToast('‚ö†Ô∏è Please enter your name!'); return; }
    if(!phone){ showToast('‚ö†Ô∏è Please enter phone number!'); return; }
    orderDetails=`üõçÔ∏è *Order Type:* Pickup\nüë§ *Name:* ${name}\nüìû *Phone:* ${phone}`;
  } else {
    const phone=document.getElementById('deliveryPhone')?document.getElementById('deliveryPhone').value.trim():'';
    const address=document.getElementById('manualAddress')?document.getElementById('manualAddress').value.trim():'';
    if(!address){ showToast('‚ö†Ô∏è Please provide delivery address!'); return; }
    if(!phone){ showToast('‚ö†Ô∏è Please enter phone number!'); return; }
    orderDetails=`üè† *Order Type:* Home Delivery\nüìç *Address:* ${address}\nüìû *Phone:* ${phone}`;
  }

  let itemsList='';
  keys.forEach(key=>{
    const info=cart[key+'__info'], qty=cart[key];
    subtotal+=info.price*qty;
    itemsList+=`‚Ä¢ ${info.name} √ó ${qty} = Rs ${(info.price*qty).toLocaleString()}\n`;
  });
  const tax=Math.round(subtotal*0.05), total=subtotal+tax;

  const msg=`üëë *REGAL RESTAURANT ORDER*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
${orderDetails}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üçΩÔ∏è *Order Items:*
${itemsList}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üíµ Subtotal: Rs ${subtotal.toLocaleString()}
üßæ Tax (5%): Rs ${tax.toLocaleString()}
üí∞ *TOTAL: Rs ${total.toLocaleString()}*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Thank you for choosing Regal Restaurant! üëëüôè`;

  window.open(`https://wa.me/923001823313?text=${encodeURIComponent(msg)}`, '_blank');
}

function showToast(msg) {
  const t=document.getElementById('toast');
  t.textContent=msg; t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),2500);
}

init();
</script>
</body>
</html>